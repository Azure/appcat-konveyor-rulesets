- category: mandatory
  customVariables: []
  description: WebLogic proprietary lifecycle/startup APIs detected
  effort: 3
  labels:
  - source=weblogic
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=jakarta-ee
  - weblogic
  - startup
  - lifecycle
  - jakarta
  - ejb
  - web-app
  links:
  - title: Jakarta Servlet Specification
    url: https://jakarta.ee/specifications/servlet/
  - title: Jakarta Contexts and Dependency Injection (CDI)
    url: https://jakarta.ee/specifications/cdi/
  - title: Jakarta Enterprise Beans Specification
    url: https://jakarta.ee/specifications/enterprise-beans/
  message: |-
    Detected WebLogic proprietary lifecycle/startup hooks (not portable):
    - `weblogic.common.T3StartupDef` / `weblogic.common.T3ServicesDef`
    - `weblogic.application.ApplicationLifecycleEvent` / `weblogic.application.ApplicationLifecycleListener`

    Recommended migration (portable patterns):
    - EJB eager init: `jakarta.ejb.Singleton` + `jakarta.ejb.Startup`
    - Web app lifecycle: `jakarta.servlet.ServletContextListener` + `jakarta.servlet.annotation.WebListener`
    - CDI lifecycle: use a CDI startup observer pattern (runtime dependent); avoid vendor lifecycle listeners.

    Replace vendor services with standard APIs:
    - Scheduling: EJB Timer (`jakarta.ejb.Schedule`) or Jakarta Concurrency (when provided by the runtime)
    - Logging: use application logging (SLF4J facade / JUL) instead of container services
  ruleID: weblogic-portability-lifecycle-01000
  when:
    or:
    - java.referenced:
        location: IMPLEMENTS_TYPE
        pattern: weblogic.common.T3StartupDef
    - java.referenced:
        location: IMPLEMENTS_TYPE
        pattern: weblogic.common.T3ServicesDef
    - java.referenced:
        location: IMPLEMENTS_TYPE
        pattern: weblogic.application.ApplicationLifecycleListener
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.application.ApplicationLifecycleEvent.*
    - java.referenced:
        pattern: weblogic.application.ApplicationLifecycleListener
    - java.referenced:
        pattern: weblogic.application.ApplicationLifecycleEvent

- category: mandatory
  customVariables: []
  description: WebLogic proprietary servlet annotations detected
  effort: 2
  labels:
  - source=weblogic
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=jakarta-ee
  - web-app
  - weblogic
  - servlet
  - jakarta
  links:
  - title: Jakarta Servlet Specification
    url: https://jakarta.ee/specifications/servlet/
  message: |-
    Detected WebLogic proprietary servlet annotations. Replace with portable Jakarta Servlet annotations:
    - `weblogic.servlet.annotation.WLServlet` -> `jakarta.servlet.annotation.WebServlet`
    - `weblogic.servlet.annotation.WLFilter` -> `jakarta.servlet.annotation.WebFilter`
    - `weblogic.servlet.annotation.WLInitParam` -> `jakarta.servlet.annotation.WebInitParam`
  ruleID: weblogic-portability-servlet-01000
  when:
    or:
    - java.referenced:
        location: ANNOTATION
        pattern: weblogic.servlet.annotation.WLServlet
    - java.referenced:
        location: ANNOTATION
        pattern: weblogic.servlet.annotation.WLInitParam
    - java.referenced:
        location: ANNOTATION
        pattern: weblogic.servlet.annotation.WLFilter

- category: mandatory
  customVariables: []
  description: WebLogic proprietary web services APIs detected
  effort: 3
  labels:
  - source=weblogic
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=jakarta-ee
  - webservice
  - weblogic
  - jakarta
  links:
  - title: Jakarta XML Web Services Specification
    url: https://jakarta.ee/specifications/xml-web-services/
  - title: Jakarta XML Binding Specification
    url: https://jakarta.ee/specifications/xml-binding/
  message: |-
    Detected WebLogic proprietary web service APIs / generated artifacts (`weblogic.wsee.*`, `weblogic.webservice*`, ClientGen).
    These are vendor-specific and not portable.

    Recommended migration:
    - Prefer a portable SOAP approach supported by the target runtime, or use an external SOAP stack/library if the runtime does not provide compatible SOAP APIs.
    - Re-generate artifacts from WSDL using standard tooling instead of relying on WebLogic ClientGen outputs.
  ruleID: weblogic-webservices-eap7-01000
  when:
    or:
    # High precision: concrete classes and call sites, avoid package-only matching.
    - java.referenced:
        pattern: weblogic.wsee.tools.clientgen.ClientGen
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.wsee.*
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.webservice.*
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.webservices.*

- category: mandatory
  customVariables: []
  description: WebLogic proprietary web security APIs detected
  effort: 3
  labels:
  - source=weblogic
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=jakarta-ee
  - web-app
  - weblogic
  - security
  - jakarta
  links:
  - title: Jakarta Security Specification
    url: https://jakarta.ee/specifications/security/
  - title: Jakarta Servlet Specification
    url: https://jakarta.ee/specifications/servlet/
  message: |-
    Detected WebLogic proprietary security APIs in use (not portable), e.g. `weblogic.servlet.security.ServletAuthentication`.
    Replace with portable mechanisms:
    - Declarative security (`jakarta.annotation.security.*`) + container-managed roles/constraints
    - Programmatic web login/logout: `HttpServletRequest.authenticate/login/logout`
    - Application-level authN/authZ integration: Jakarta Security (`jakarta.security.enterprise`)
  ruleID: weblogic-webapp-eap7-07000
  when:
    or:
    # Prefer concrete API usage over package presence.
    - java.referenced:
        pattern: weblogic.servlet.security.ServletAuthentication
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.servlet.security.ServletAuthentication.*
    # Keep a narrow weblogic.security trigger: method calls only (avoid broad PACKAGE).
    - java.referenced:
        location: METHOD_CALL
        pattern: weblogic.security.*