# Copyright (c) Microsoft Corporation.   

# Licensed under the Apache License, Version 2.0 (the "License"); 
# you may not use this file except in compliance with the License. 
# You may obtain a copy of the License at 
#     http://www.apache.org/licenses/LICENSE-2.0  

# Unless required by applicable law or agreed to in writing, software 
# distributed under the License is distributed on an "AS IS" BASIS, 
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 

# See the License for the specific language governing permissions and 
# limitations under the License. 
- category: mandatory
  customVariables: []
  description: Azure Java Track1 SDK has been officially deprecated since 31-March-2022
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - domain=java-upgrade
  - category=sdk-track1-migration
  - version
  - os=windows
  - os=linux
  links:
  - title: Migrate to Track2 Azure SDK for Java(`com.azure.**`) from Track1(`com.microsoft.azure.**`)
    url: https://aka.ms/java-track2-migration-guide
  - title: Azure for Java developer documentation
    url: https://learn.microsoft.com/azure/developer/java/
  - title: Azure SDK lifecycle and support policy
    url: https://azure.github.io/azure-sdk/policies_support.html
  message: |-
    The application is using deprecated Azure Java Track 1 SDKs (`com.microsoft.azure.*`). These libraries reached end of support on 31-Mar-2022, so you should migrate to the Track 2 SDKs (`com.azure.*`) for security fixes and new capabilities. Follow these steps:

    * **Inventory Track 1 dependencies**: Use tools such as `mvn dependency:tree` or `gradlew dependencies` to find every `com.microsoft.azure.*` artifact and map each one to its Track 2 counterpart.\n\n

    * **Adopt Track 2 packages**: Replace the Track 1 dependencies with Track 2 equivalents in your `pom.xml` or `build.gradle`, following the migration guide to align feature parity and new package names.

    * **Update application code**: Refactor your code to new builder-based APIs, updated authentication flows (Azure Identity), and modern async/reactive patterns required by Track 2 clients. Add concise comments explaining non-obvious changes.

    * **Test thoroughly**: Run unit, integration, and end-to-end tests to validate that the Track 2 clients behave as expected, focusing on authentication, retry, and serialization differences.
  ruleID: azure-java-sdk-track1-to-track2-01000
  when:
    or:
    # https://aka.ms/java-track2-migration-guide
    - java.dependency:
        nameregex: com\.microsoft\.azure\..*
    - java.referenced:
        location: IMPORT
        pattern: com.microsoft.azure*