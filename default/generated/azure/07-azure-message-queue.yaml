# Copyright (c) Microsoft Corporation.   

# Licensed under the Apache License, Version 2.0 (the "License"); 
# you may not use this file except in compliance with the License. 
# You may obtain a copy of the License at 
#     http://www.apache.org/licenses/LICENSE-2.0  

# Unless required by applicable law or agreed to in writing, software 
# distributed under the License is distributed on an "AS IS" BASIS, 
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 

# See the License for the specific language governing permissions and 
# limitations under the License. 
- category: optional
  customVariables: []
  description: Kafka connection string, username or password found in configuration
    file
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - kafka
  - os=windows
  - os=linux
  links:
  - title: Spring Boot app to Kafka on Confluent Cloud
    url: https://learn.microsoft.com/azure/service-connector/tutorial-java-spring-confluent-kafka
  - title: Apache Kafka on Confluent Cloud - Azure Native ISV Service Documentation
    url: https://learn.microsoft.com/azure/partner-solutions/apache-kafka-confluent-cloud
  - title: Passwordless connections for Azure services
    url: https://learn.microsoft.com/azure/developer/intro/passwordless-overview
  message: "The application uses a Kafka connection string or password. To migrate
    a Java application that uses a Kafka connection string to Azure, you can follow
    these recommendations:\n\n * **Provision an Apache Kafka for Confluent Cloud**:
    Consider moving to Apache Kafka for Confluent Cloud to reduce the burden of cross-platform
    management. Microsoft partnered with Confluent Cloud to build an integrated provisioning
    layer from Azure to Confluent Cloud. You can easily integrate and manage Confluent
    Cloud with your Azure applications.\n\n * **Connect to Apache Kafka for Confluent
    Cloud using Service Connector**: Create service connection using **Service Connector**
    to connect your Apache Kafka on Confluent Cloud to your azure app. Instead of
    manually configuring connection string in your applications, you can automatically
    connect Apache Kafka for Confluent Cloud using Service Connector. \n\n * **Passwordless
    connections for Azure services**: Consider using passwordless connections for
    Azure services. You can provide an additional layer of security and convenience
    for accessing resources in Azure by eliminating the need for passwords. This way
    you can reduce the risk of password-related vulnerabilities, such as weak passwords
    or password theft."
  ruleID: azure-message-queue-config-kafka-01000
  when:
    or:
    - java.dependency:
        lowerbound: 0.0.0
        nameregex: ([a-zA-Z0-9._-]*)kafka([a-zA-Z0-9._-]*)
    - builtin.filecontent:
        filePattern: (/|\\)(application|bootstrap)(-[a-zA-Z0-9]+)*?\.(properties|yaml|yml)$
        pattern: (?i)(?:\.kafka\.|bootstrap\.servers|bootstrap:\s*servers)
- category: optional
  customVariables: []
  description: RabbitMQ connection string, username or password found in configuration
    file
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - RabbitMQ Client
  - os=windows
  - os=linux
  links:
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Service connection in Azure Container Apps
    url: https://learn.microsoft.com/azure/service-connector/quickstart-portal-container-apps
  - title: Passwordless connections for Azure services
    url: https://learn.microsoft.com/azure/developer/intro/passwordless-overview
  message: "The application uses a RabbitMQ connection string, username, or password.
    To migrate a Java application that uses a RabbitMQ connection string to Azure,
    you can follow these recommendations:\n\n * Provision **Azure Service Bus**: Replace
    RabbitMQ with Azure Service Bus, a fully managed messaging service that offers
    reliable message queuing and publish/subscribe capabilities.\n\n * **Connect to
    Azure Service Bus using Service Connector**: Create service connection using **Service
    Connector** to connect your Azure Service Bus to your azure app. Instead of manually
    configuring connection string in your applications, you can automatically connect
    Azure Service Bus using Service Connector.\n \n * **Passwordless connections for
    Azure services**: Consider using passwordless connections for Azure services.
    You can provide an additional layer of security and convenience for accessing
    resources in Azure by eliminating the need for passwords. This way you can reduce
    the risk of password-related vulnerabilities, such as weak passwords or password
    theft."
  ruleID: azure-message-queue-config-rabbitmq-01000
  when:
    builtin.filecontent:
      filePattern: (/|\\)(application|bootstrap)(-[a-zA-Z0-9]+)*?\.(properties|yaml|yml)$
      pattern: rabbitmq\.(.*\.)?(addresses|host|virtual-host|username|password)
- category: optional
  customVariables: []
  description: ActiveMQ Artemis connection string, username or password found in configuration
    file
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - ActiveMQ
  - os=windows
  - os=linux
  links:
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Migrate existing Java Message Service applications from Apache ActiveMQ
      to Azure Service Bus
    url: https://learn.microsoft.com/azure/service-bus-messaging/migrate-jms-activemq-to-servicebus
  - title: Service connection in Azure Container Apps
    url: https://learn.microsoft.com/azure/service-connector/quickstart-portal-container-apps
  - title: Passwordless connections for Azure services
    url: https://learn.microsoft.com/azure/developer/intro/passwordless-overview
  message: |-
    The application uses an ActiveMQ Artemis connection string, username, or password. To migrate a Java application that uses an ActiveMQ Artemis connection string to Azure, you can follow these recommendations:

     * Provision **Azure Service Bus**: Replace ActiveMQ with Azure Service Bus, a fully managed messaging service that offers reliable message queuing and publish/subscribe capabilities.

     * **Connect to Azure Service Bus using Service Connector**: Create service connection using **Service Connector** to connect your Azure Service Bus to your azure app. Instead of manually configuring connection string in your applications, you can automatically connect Azure Service Bus using Service Connector.

     * **Passwordless connections for Azure services**: Consider using passwordless connections for Azure services. You can provide an additional layer of security and convenience for accessing resources in Azure by eliminating the need for passwords. This way you can reduce the risk of password-related vulnerabilities, such as weak passwords or password theft.
  ruleID: azure-message-queue-config-artemis-01000
  when:
    builtin.filecontent:
      filePattern: (/|\\)(application|bootstrap)(-[a-zA-Z0-9]+)*?\.(properties|yaml|yml)$
      pattern: artemis\.(broker-url|user|password)
- category: optional
  customVariables: []
  description: Spring RabbitMQ usage found in code
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - RabbitMQ Client
  - os=windows
  - os=linux
  links:
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Use Azure Service Bus in Spring applications
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/using-service-bus-in-spring-applications
  message: |-
    The application uses Spring RabbitMQ based on Spring AMQP in code. To migrate a Java application that uses Spring RabbitMQ to Azure, you can follow these recommendations:

     * Provision **Azure Service Bus**: Replace RabbitMQ with Azure Service Bus, a fully managed messaging service that offers reliable message queuing and publish/subscribe capabilities.

     * Update the application's **messaging connection** details: Modify the Java application's configuration updating the connection information and message queues/topics.

     * Configure Azure Service Bus **queues/topics**: Create appropriate queues or topics in Azure Service Bus to align with your application's messaging requirements. Configure access control and security settings as needed.
  ruleID: azure-message-queue-rabbitmq-01000
  when:
    java.referenced:
      location: PACKAGE
      pattern: org.springframework.amqp.rabbit*
- category: optional
  customVariables: []
  description: Spring AMQP dependency found
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - AMQP Client
  - os=windows
  - os=linux
  links:
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Use Azure Service Bus in Spring applications
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/using-service-bus-in-spring-applications
  message: |-
    The application uses Spring AMQP dependency. To migrate a Java application that uses Spring AMQP to Azure, you can follow these recommendations:

     * Provision **Azure Service Bus**: Use Azure Service Bus, a fully managed messaging service that offers reliable message queuing and publish/subscribe capabilities.

     * Update the application's **messaging connection** details: Modify the Java application's configuration updating the connection information and message queues/topics.

     * Configure Azure Service Bus **queues/topics**: Create appropriate queues or topics in Azure Service Bus to align with your application's messaging requirements. Configure access control and security settings as needed.
  ruleID: azure-message-queue-amqp-02000
  when:
    and:
      - or:
          - java.dependency:
              lowerbound: 0.0.0
              name: org.springframework.boot.spring-boot-starter-amqp
          - java.dependency:
              lowerbound: 0.0.0
              name: org.springframework.amqp.spring-rabbit
          - builtin.filecontent:
              filePattern: (/|\\)build\.gradle$
              pattern: spring-boot-starter-amqp
          - builtin.filecontent:
              filePattern: (/|\\)([a-zA-Z0-9._-]+)\.(xml|properties|yaml|yml)$
              pattern: .*amqp.*
      - not: true
        or:
          - java.dependency:
              lowerbound: 0.0.0
              nameregex: ([a-zA-Z0-9._-]*)jakarta.jakartaee-api([a-zA-Z0-9._-]*)
          - java.dependency:
              lowerbound: 0.0.0
              nameregex: ([a-zA-Z0-9._-]*)javaee-api([a-zA-Z0-9._-]*)
- category: optional
  customVariables: []
  description: Spring JMS RabbitMQ dependency found
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - RabbitMQ Client
  - os=windows
  - os=linux
  links:
  - title: Use JMS in Spring to access Azure Service Bus
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-service-bus
  - title: Use Azure Service Bus with JMS
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/spring-jms-support
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Use Azure Service Bus in Spring applications
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/using-service-bus-in-spring-applications
  message: |-
    The application uses Spring JMS RabbitMQ dependency. It is recommended to migrate to Azure Service Bus with Spring JMS

     * Replace RabbitMQ dependencies with Azure Service Bus dependencies: Remove RabbitMQ dependencies and add Azure Service Bus dependencies: com.azure.spring spring-cloud-azure-dependencies, com.azure.spring spring-cloud-azure-starter-servicebus-jms.
     * Replace RabbitMQ connection details with Azure Service Bus connection details: Modify the Java application's configuration updating the connection information and message queues/topics.
  ruleID: azure-message-queue-spring-jms-rabbitmq-01000
  when:
    and:
    - java.dependency:
        lowerbound: 0.0.0
        nameregex: org\.springframework.*jms
    - java.dependency:
        lowerbound: 0.0.0
        nameregex: com\.rabbitmq.*\.rabbitmq-jms
- category: potential
  customVariables: []
  description: ActiveMQ found
  effort: 3
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - ActiveMQ
  - os=windows
  - os=linux
  links:
  - title: Spring Boot application using an Active MQ Broker
    url: https://learn.microsoft.com/en-us/azure/developer/java/migration/migrate-spring-boot-to-azure-container-apps#jms-message-brokers
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  - title: Migrate existing Java Message Service applications from Apache ActiveMQ
      to Azure Service Bus
    url: https://learn.microsoft.com/azure/service-bus-messaging/migrate-jms-activemq-to-servicebus
  - title: Azure Monitor documentation
    url: https://learn.microsoft.com/azure/azure-monitor
  - title: Passwordless connections for Azure services
    url: https://learn.microsoft.com/azure/developer/intro/passwordless-overview
  - title: Microsoft Defender for Cloud
    url: https://learn.microsoft.com/azure/defender-for-cloud
  - title: How to use the Spring Boot Starter for Azure Service Bus JMS
    url: https://docs.microsoft.com/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-service-bus
  - title: Azure Spring Boot Starter for Azure Service Bus JMS
    url: https://search.maven.org/artifact/com.azure.spring/azure-spring-boot-starter-servicebus-jms
  message: |-
    To migrate a Java application that uses ActiveMQ to Azure, you can follow these recommendations:

     * Provision **Azure Service Bus**: Replace ActiveMQ with Azure Service Bus, a fully managed messaging service that offers reliable message queuing and publish/subscribe capabilities.

     * Update the application's **messaging connection** details: Modify the Java application's configuration updating the connection information and message queues/topics.

     * Configure Azure Service Bus **queues/topics**: Create appropriate queues or topics in Azure Service Bus to align with your application's messaging requirements. Configure access control and security settings as needed.

     * Handle **message persistence**: ActiveMQ often relies on disk storage for message persistence. Azure Service Bus offers built-in message persistence, ensuring reliable message delivery. Ensure your application's messaging code handles message persistence appropriately.

     * Enable **monitoring and diagnostics**: Utilize Azure Monitor and Microsoft Defender for Cloud to monitor and detect any potential security threats or anomalies in your Azure Service Bus environment. Enable diagnostics logging and set up alerts for suspicious activities.

     * Apply **security** measures: Implement Azure Active Directory (Azure AD) authentication and authorization for accessing Azure Service Bus resources. Enable TLS encryption for communication between your Java application and Azure Service Bus. Enable passwordless connections for Azure services to improve security and reduce the risk of credential theft.
  ruleID: azure-message-queue-activemq-01000
  when:
    or:
    - java.dependency:
        lowerbound: 0.0.0
        name: org.springframework.boot.spring-boot-starter-activemq
    - java.dependency:
        lowerbound: 0.0.0
        nameregex: org\.apache\.activemq\.([a-zA-Z0-9._-]*)
    - builtin.file:
        pattern: ^([a-zA-Z0-9._-]*)activemq([a-zA-Z0-9._-]*)$
- category: optional
  customVariables: []
  description: Java EE or Jakarta EE application using RabbitMQ AMQP found
  effort: 5
  labels:
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - AMQP Client
  - os=windows
  - os=linux
  - JavaEE
  - JakartaEE
  links:
  - title: Azure Service Bus documentation
    url: https://learn.microsoft.com/azure/service-bus-messaging
  message: |-
    The application is a Java EE or Jakarta EE project using RabbitMQ AMQP for messaging. To migrate this application to Azure, you can follow these recommendations:

     * **Provision Azure Service Bus**: Replace RabbitMQ with Azure Service Bus, a fully managed messaging service that offers reliable message queuing and publish/subscribe capabilities with JMS 2.0 support.

     * **Update messaging dependencies**: Replace RabbitMQ AMQP client dependencies with Azure Service Bus JMS libraries. For Jakarta EE applications, ensure you use the appropriate Jakarta namespace dependencies.

     * **Configure Azure Service Bus queues/topics**: Create appropriate queues or topics in Azure Service Bus to align with your application's messaging requirements. Configure access control and security settings as needed.
  ruleID: azure-message-queue-java-ee-rabbitmq-amqp-01000
  when:
    and:
    - or:
      - java.dependency:
          lowerbound: 0.0.0
          nameregex: ([a-zA-Z0-9._-]*)jakarta.jakartaee-api([a-zA-Z0-9._-]*)
      - java.dependency:
          lowerbound: 0.0.0
          nameregex: ([a-zA-Z0-9._-]*)javaee-api([a-zA-Z0-9._-]*)
    - or:
      - java.dependency:
          lowerbound: 0.0.0
          nameregex: ([a-zA-Z0-9._-]*)amqp-client([a-zA-Z0-9._-]*)
      - builtin.filecontent:
          filePattern: (/|\\)(application|bootstrap|web)(-[a-zA-Z0-9]+)*?\.(properties|xml|yaml|yml)$
          pattern: rabbitmq\.(.*\.)?(addresses|host|virtual-host|username|password)
      - java.referenced:
          location: PACKAGE
          pattern: com.rabbitmq.client*
    - not: true
      or:
      - java.referenced:
          location: PACKAGE
          pattern: org.springframework.amqp.rabbit*
      - java.dependency:
          lowerbound: 0.0.0
          name: org.springframework.boot.spring-boot-starter-amqp
      - java.dependency:
          lowerbound: 0.0.0
          name: org.springframework.amqp.spring-rabbit

- category: optional
  customVariables: []
  description: IBM MQ usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - domain=cloud-readiness
  - category=messaging-service-migration
  - message-queue
  - ibm-mq
  - os=windows
  - os=linux
  links:
  - title: Use JMS in Spring to access Azure Service Bus
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-service-bus
  - title: Use Azure Service Bus with JMS
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/spring-jms-support
  - title: Azure Service Bus JMS 2.0 developer guide
    url: https://learn.microsoft.com/en-us/azure/service-bus-messaging/jms-developer-guide
  - title: Use Java Message Service 2.0 API with Azure Service Bus Premium
    url: https://learn.microsoft.com/en-us/azure/service-bus-messaging/how-to-use-java-message-service-20
  message: |-
    The application uses IBM MQ JMS. Consider migrating to Azure Service Bus.
    Azure Service Bus provides a reliable cloud messaging service between applications and services.
    You will need to replace IBM MQ specific code and dependencies with Azure Service Bus SDK or JMS with Service Bus.
  ruleID: azure-message-queue-ibm-jms-01000
  when:
    or:
    - java.dependency:
        name: com.ibm.mq.com.ibm.mq.allclient
    - java.dependency:
        name: com.ibm.mq.mq-jms-spring-boot-starter

- category: optional
  customVariables: []
  description: Amazon SNS usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=messaging-service-migration
  - amazon-sns
  - azure-service-bus
  links:
  - title: Get started with Service Bus topics and subscriptions (Java)
    url: https://learn.microsoft.com/azure/service-bus-messaging/service-bus-java-how-to-use-topics-subscriptions
  - title: Azure Service Bus client library for Java (azure-messaging-servicebus)
    url: https://learn.microsoft.com/java/api/overview/azure/messaging-servicebus-readme
  - title: Messaging services on Azure and AWS
    url: https://learn.microsoft.com/en-us/azure/architecture/aws-professional/messaging
  - title: Use Azure Service Bus in Spring applications
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/using-service-bus-in-spring-applications
  message: |-
    The application uses Amazon SNS for pub/sub messaging. Consider migrating to Azure Service Bus.
    Azure Service Bus Topics and Subscriptions provide durable, reliable pub/sub messaging with filtering and dead-lettering.
    You will need to replace AWS SNS SDK usage (publishing, subscription management, credentials/config) with Azure Service Bus topic/subscription entities and the Azure Service Bus SDK (or an appropriate framework integration).
  ruleID: amazon-sns-to-azure-servicebus-01000
  when:
    or:
    - java.dependency:
        name: software.amazon.awssdk.sns
    - java.dependency:
        name: com.amazonaws.aws-java-sdk-sns
    - java.dependency:
        name: io.awspring.cloud.spring-cloud-aws-sns
    - java.dependency:
        name: io.awspring.cloud.spring-cloud-aws-starter-sns

- category: optional
  customVariables: []
  description: TIBCO EMS JMS usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=messaging-service-migration
  - tibco-ems-jms
  - azure-service-bus-jms
  links:
  - title: Use JMS in Spring to access Azure Service Bus
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-service-bus
  - title: Use Azure Service Bus with JMS
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/spring-jms-support
  - title: Azure Service Bus JMS 2.0 developer guide
    url: https://learn.microsoft.com/azure/service-bus-messaging/jms-developer-guide
  - title: Use Java Message Service 2.0 API with Azure Service Bus Premium
    url: https://learn.microsoft.com/azure/service-bus-messaging/how-to-use-java-message-service-20
  message: |-
    The application uses TIBCO EMS via the Java Message Service (JMS) API. Consider migrating to Azure Service Bus with JMS.
    Azure Service Bus Premium provides full JMS 2.0 API support, enabling a drop-in replacement approach for many JMS-based applications.
    You will need to replace TIBCO EMS client libraries, connection factories/JNDI configuration, and broker-specific settings with Azure Service Bus JMS connection settings and supported JMS features.
  ruleID: tibco-ems-jms-to-azure-servicebus-jms-01000
  when:
    or:
    - java.dependency:
        name: com.tibco.tibjms.tibjms
    - java.dependency:
        name: com.tibco.tibjms
    - java.dependency:
        name: com.tibco.tibjmsadmin
    - builtin.file:
        pattern: tibjms\.jar
    - java.referenced:
        location: IMPORT
        pattern: com.tibco.tibjms*
    - java.referenced:
        pattern: com.tibco.tibjms.admin*
    - java.referenced:
        pattern: com.tibco.tibjms.naming*

- category: optional
  customVariables: []
  description: Solace PubSub+ usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=messaging-service-migration
  - solace-pubsubplus
  - azure-service-bus
  links:
  - title: Get started with Service Bus topics and subscriptions (Java)
    url: https://learn.microsoft.com/azure/service-bus-messaging/service-bus-java-how-to-use-topics-subscriptions
  - title: Azure Service Bus client library for Java (azure-messaging-servicebus)
    url: https://learn.microsoft.com/java/api/overview/azure/messaging-servicebus-readme
  - title: Messaging services on Azure and AWS
    url: https://learn.microsoft.com/en-us/azure/architecture/aws-professional/messaging
  - title: Spring Cloud Stream with Azure Service Bus
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/configure-spring-cloud-stream-binder-java-app-with-service-bus
  message: |-
    The application uses Solace PubSub+ for enterprise messaging. Consider migrating to Azure Service Bus.
    Azure Service Bus supports equivalent enterprise messaging patterns including queues (point-to-point), topics/subscriptions (pub/sub), and request/reply-style workflows, with AMQP 1.0 support and JMS 2.0 support (Premium).
    You will need to replace Solace PubSub+ client libraries and broker-specific configuration (sessions, endpoints/queues, topics, authentication, connection properties) with Azure Service Bus entities and either the Azure Service Bus SDK, AMQP, or JMS (depending on your application integration style).
  ruleID: solace-pubsubplus-to-azure-servicebus-01000
  when:
    or:
    - java.dependency:
        name: com.solacesystems.sol-jms
    - java.dependency:
        name: com.solacesystems.sol-jcsmp
    - java.dependency:
        name: com.solacesystems.sol-common
    - java.dependency:
        name: com.solacesystems.sol-jms-jakarta
    - java.dependency:
        name: com.solace.spring.cloud.spring-cloud-starter-stream-solace
    - java.dependency:
        name: com.solace.spring.cloud.spring-cloud-stream-binder-solace
    - java.referenced:
        location: IMPORT
        pattern: com.solacesystems.jms*
    - java.referenced:
        location: IMPORT
        pattern: com.solacesystems.jcsmp*

- category: optional
  customVariables: []
  description: Amazon Kinesis usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=messaging-service-migration
  - amazon-kinesis
  - azure-event-hubs
  links:
  - title: What is Azure Event Hubs?
    url: https://learn.microsoft.com/azure/event-hubs/event-hubs-about
  - title: Event Hubs client library for Java (azure-messaging-eventhubs)
    url: https://learn.microsoft.com/java/api/overview/azure/messaging-eventhubs-readme
  message: |-
    The application uses Amazon Kinesis for streaming data ingestion/processing. Consider migrating to Azure Event Hubs.
    Azure Event Hubs is a high-throughput event streaming platform and supports the Kafka protocol, enabling Kafka-compatible producers/consumers to connect without changing Kafka client code.
    You will need to replace AWS Kinesis client usage (streams, producers/consumers, checkpointing, IAM/credentials, region/endpoints) with Azure Event Hubs concepts (event hubs, consumer groups, checkpoints via Azure Storage) and either the Event Hubs SDK or the Kafka endpoint (depending on your client library).
  ruleID: amazon-kinesis-to-azure-eventhubs-01000
  when:
    or:
    - java.dependency:
        name: software.amazon.awssdk.kinesis
    - java.dependency:
        name: software.amazon.kinesis.amazon-kinesis-client
    - java.dependency:
        name: com.amazonaws.aws-java-sdk-kinesis
    - java.dependency:
        name: com.amazonaws.amazon-kinesis-client
    - java.dependency:
        name: com.amazonaws.amazon-kinesis-producer

- category: optional
  customVariables: []
  description: Apache Pulsar usage detected
  effort: 5
  labels:
  - source
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=messaging-service-migration
  - apache-pulsar
  - azure-event-hubs
  links:
  - title: What is Azure Event Hubs?
    url: https://learn.microsoft.com/azure/event-hubs/event-hubs-about
  - title: Event Hubs client library for Java (azure-messaging-eventhubs)
    url: https://learn.microsoft.com/java/api/overview/azure/messaging-eventhubs-readme
  message: |-
    The application uses Apache Pulsar for real-time messaging/streaming. Consider migrating to Azure Event Hubs.
    Azure Event Hubs is a managed event streaming platform and provides a Kafka-compatible endpoint, enabling Kafka client applications to connect using the Kafka protocol.
    You will need to replace Pulsar client usage (producers/consumers, topics/subscriptions, authentication, and geo/multi-tenant configuration) with Azure Event Hubs concepts (event hubs, consumer groups, checkpoints via Azure Storage) and connect using either the Event Hubs SDK or Kafka clients against the Event Hubs Kafka endpoint.
  ruleID: apache-pulsar-to-azure-eventhubs-01000
  when:
    or:
    - java.dependency:
        nameregex: org\.apache\.pulsar.*
    - java.dependency:
        nameregex: io\.streamnative.*pulsar.*