- category: mandatory
  customVariables: []
  description: Google Cloud Pub/Sub usage detected
  effort: 3
  labels:
  - source=google-cloud-pubsub
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - domain=cloud-readiness
  - category=messaging-service-migration
  - os=windows
  - os=linux
  links:
  - title: Get started with Service Bus topics and subscriptions (Java)
    url: https://learn.microsoft.com/azure/service-bus-messaging/service-bus-java-how-to-use-topics-subscriptions
  - title: Azure Service Bus client library for Java (azure-messaging-servicebus)
    url: https://learn.microsoft.com/java/api/overview/azure/messaging-servicebus-readme
  - title: Messaging services on Azure and AWS
    url: https://learn.microsoft.com/en-us/azure/architecture/aws-professional/messaging
  - title: Use Azure Service Bus in Spring applications
    url: https://learn.microsoft.com/azure/developer/java/spring-framework/using-service-bus-in-spring-applications
  message: |-
    The application uses Google Cloud Pub/Sub for pub/sub messaging. Consider migrating to Azure Service Bus Topics.
    Azure Service Bus Topics and Subscriptions provide durable pub/sub messaging with at-least-once delivery, filtering, and dead-lettering.
    You will need to replace Google Cloud Pub/Sub client usage (publish/subscribe, subscription administration, authentication and configuration) with Azure Service Bus topic/subscription entities and the Azure Service Bus SDK (or an appropriate framework integration).
  ruleID: google-pubsub-to-azure-service-bus-01000
  when:
    or:
    - java.dependency:
        name: com.google.cloud.google-cloud-pubsub
    - java.dependency:
        name: com.google.cloud.spring-cloud-gcp-starter-pubsub
    - java.dependency:
        name: org.springframework.cloud.spring-cloud-gcp-pubsub
    - java.dependency:
        name: com.google.cloud.spring-cloud-gcp-pubsub
    - java.dependency:
        nameregex: com.google.api.grpc.grpc-google-cloud-pubsub-v1
- category: mandatory
  customVariables: []
  description: Google Container Registry (GCR) or Artifact Registry usage detected
  effort: 3
  labels:
  - source=google-gcr
  - target=azure-aks
  - target=azure-container-apps
  - domain=cloud-readiness
  - category=container-registry
  - os=windows
  - os=linux
  links:
  - title: Azure Container Registry documentation
    url: https://learn.microsoft.com/en-us/azure/container-registry/
  - title: Migrate from Google Container Registry to Azure Container Registry
    url: https://learn.microsoft.com/en-us/azure/container-registry/container-registry-import-images
  - title: Azure Container Registry best practices
    url: https://learn.microsoft.com/en-us/azure/container-registry/container-registry-best-practices
  message: |-
    The application uses Google Container Registry (gcr.io) or Google Artifact Registry ([location]-docker.pkg.dev) for container images.

    **Common patterns detected may include:**
    * Container image references in Dockerfiles and docker-compose files
    * Kubernetes manifests (Deployments, StatefulSets, DaemonSets, Jobs, CronJobs, Pods) with GCR images
    * Configuration files referencing GCR endpoints

    **To migrate to Azure Container Registry (ACR):**
    * **Provision Azure Container Registry:**
       * Create an ACR instance: `az acr create --name <registry-name> --resource-group <rg> --sku Standard`
    * **Migrate container images:**
       * Import images from GCR: `az acr import --name <acr-name> --source gcr.io/<project>/<image>:<tag> --image <image>:<tag>`
       * Or use docker pull/push: `docker pull gcr.io/<project>/<image>` then `docker push <acr-name>.azurecr.io/<image>`
    * **Update image references:**
       * Replace `gcr.io/<project>/<image>` with `<acr-name>.azurecr.io/<image>`
       * Replace `<location>-docker.pkg.dev/<project>/<repo>/<image>` with `<acr-name>.azurecr.io/<image>`
       * Update all Dockerfiles, docker-compose files, Kubernetes manifests, and Helm charts
    * **Configure authentication:**
       * **For AKS (recommended):** Enable managed identity integration: `az aks update --name <aks-cluster> --attach-acr <acr-name>`
       * **For other services:** Use Azure managed identities or service principals
       * **For local development:** Use `az acr login --name <acr-name>`
    * **Remove GCR-specific tooling:**
       * Replace gcloud docker authentication with Azure CLI or service principals
    * **For language packages (if using Artifact Registry for npm/Maven/Python):**
       * Use Azure Artifacts for package management instead of Google Artifact Registry
  ruleID: google-gcr-to-azure-acr-01000
  when:
    or:
    - builtin.filecontent:
        filePattern: (?i)(dockerfile|\.dockerignore|docker-compose\.ya?ml|.*\.ya?ml|.*\.json|\.properties|pom\.xml|build\.gradle|package\.json|requirements\.txt|\.npmrc|\.pypirc|Makefile|.*\.sh|.*\.ps1)$
        pattern: (gcr\.io|[a-z]+-docker\.pkg\.dev)

- category: optional
  customVariables: []
  description: Google Cloud Storage usage detected
  effort: 5
  labels:
  - source=google-cloud-storage
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=storage-migration
  links:
  - title: What is Azure Blob Storage?
    url: https://learn.microsoft.com/azure/storage/blobs/storage-blobs-overview
  - title: Quickstart - Upload, download, and list blobs with Java
    url: https://learn.microsoft.com/azure/storage/blobs/storage-quickstart-blobs-java
  - title: Azure Storage Blobs client library for Java
    url: https://learn.microsoft.com/java/api/overview/azure/storage-blob-readme
  - title: Authorize access to blobs using Microsoft Entra ID
    url: https://learn.microsoft.com/azure/storage/blobs/authorize-access-azure-active-directory
  - title: Use Spring Boot to upload a file to Azure Blob Storage
    url: https://learn.microsoft.com/en-us/azure/developer/java/spring-framework/configure-spring-boot-starter-java-app-with-azure-storage
  message: |-
    The application uses Google Cloud Storage for object storage. Consider migrating to Azure Blob Storage.
    Azure Blob Storage provides equivalent object storage capabilities for unstructured data with multiple access tiers and enterprise security controls.
    You will need to replace GCS client usage (buckets/objects, IAM/ACLs, signed URLs, endpoints and authentication) with Azure Blob concepts (storage accounts, containers, blobs) and the Azure Storage SDK, including updating identity/access control (Microsoft Entra ID/RBAC) and URL signing (SAS) as needed.
  ruleID: google-cloud-storage-to-azure-blob-storage-01000
  when:
    or:
    - java.dependency:
        name: com.google.cloud.google-cloud-storage
    - java.dependency:
        name: com.google.apis.google-api-services-storage
    - java.dependency:
        name: org.springframework.cloud.spring-cloud-gcp-storage
    - java.dependency:
        name: org.springframework.cloud.spring-cloud-gcp-starter-storage

- category: optional
  customVariables: []
  description: Google Cloud Functions usage detected
  effort: 5
  labels:
  - source=google-cloud-functions
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - os=windows
  - os=linux
  - domain=cloud-readiness
  - category=scheduled-job-migration
  links:
  - title: What is Azure Functions
    url: https://learn.microsoft.com/en-us/azure/azure-functions/functions-overview
  - title: Timer trigger for Azure Functions
    url: https://learn.microsoft.com/azure/azure-functions/functions-bindings-timer
  - title: Azure Functions Java developer guide
    url: https://learn.microsoft.com/azure/azure-functions/functions-reference-java
  message: |-
    The application uses Google Cloud Functions (Java). Consider migrating to Azure Functions.
    Azure Functions provides a managed serverless compute platform with a Java runtime and an event-driven programming model (triggers and bindings).
    You will need to replace Google Cloud Functions handlers, deployment configuration, and IAM/project configuration with Azure Functions triggers/bindings, function app deployment, and Azure identity/configuration.
  ruleID: google-cloud-functions-to-azure-functions-01000
  when:
    or:
    - java.dependency:
        nameregex: com\.google\.cloud\.functions\.functions-framework.*
    - java.dependency:
        name: org.springframework.cloud.spring-cloud-function-adapter-gcp