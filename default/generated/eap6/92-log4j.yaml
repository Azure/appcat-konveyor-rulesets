- customVariables: []
  labels:
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source=log4j
  - capability=eap6+
  - capability=eap
  - capability=java-ee6+
  - capability=java-ee
  - log4j
  links: []
  message: Deploying log4j.jar can result in non-deterministic ClassLoading issues.
    It is recommended to use the built-in JBoss EAP Log4j module configured via `jboss-deployment-structure.xml`
  ruleID: log4j-01000
  when:
    java.dependency:
      lowerbound: 0.0.0
      name: log4j.log4j
- category: optional
  customVariables: []
  description: Log4j ConsoleAppender Configuration - Potential Deadlock
  effort: 1
  labels:
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source=log4j
  - capability=eap6+
  - capability=eap
  - capability=java-ee6+
  - capability=java-ee
  - log4j
  links:
  - title: EAP 6 deadlocks when using ConsoleHandler and java.io.PrintStream
    url: https://access.redhat.com/solutions/375273
  message: |-
    Using ConsoleAppender configured in log4j.{{suffix}} can cause a deadlock on JBoss EAP 6.
     It is recommended to Remove application level log4j ConsoleAppenders.
  ruleID: log4j-03000
  when:
    builtin.filecontent:
      filePattern: log4j\.{suffix}
      pattern: org.apache.log4j.ConsoleAppender
