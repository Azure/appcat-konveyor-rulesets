- category: mandatory
  customVariables: []
  description: JBoss EAP security-domain configuration - java:/jaas/
  effort: 3
  labels:
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source=eap5
  - source=eap
  - capability=java-ee6+
  - capability=java-ee
  - jboss-eap5
  - ejb
  - seam
  - security
  - jaas
  links:
  - title: Java Authentication and Authorization Service (JAAS) Reference Guide
    url: http://docs.oracle.com/javase/7/docs/technotes/guides/security/jaas/JAASRefGuide.html
  message: |-
    `java:/jaas/` is a JBoss EAP `security-domain` URI.
     Remove the `java:/jaas/` prefix for `security-domain` elements in AS 7 / EAP 6.
  ruleID: jboss-eap5-xml-14000
  when:
    builtin.xml:
      namespaces: {}
      xpath: //*[local-name()='security-domain' and starts-with(text(), 'java:/jaas/')]
- category: mandatory
  customVariables: []
  description: JBoss 5 classloader configuration (jboss-classloading.xml)
  effort: 5
  labels:
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source=eap5
  - source=eap
  - capability=java-ee6+
  - capability=java-ee
  - jboss-eap5
  - ejb
  - seam
  - classloading
  - discovery
  links:
  - title: JBoss EAP 6 Class Loading and Modules
    url: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/chap-Class_Loading_and_Modules.html
  - title: JBoss EAP 5 Class Loading and Modules
    url: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/5/html/Microcontainer_User_Guide/sect-JBoss_Microcontainer_User_Guide-The_ClassLoading_Layer-ClassLoading.html
  - title: JBoss EAP 6 Class Loading and Modules
    url: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/6.4/html/Development_Guide/chap-Class_Loading_and_Modules.html
  - title: JBoss EAP 5 Class Loading and Modules
    url: https://access.redhat.com/documentation/en-us/JBoss_Enterprise_Application_Platform/5/html/Microcontainer_User_Guide/sect-JBoss_Microcontainer_User_Guide-The_ClassLoading_Layer-ClassLoading.html
  message: The `jboss-classloading.xml` file allows customization of classloading
    in JBoss EAP 5.
  ruleID: jboss-eap5-7-xml-10000
  when:
    builtin.xml:
      namespaces:
        jbc: urn:jboss:classloading:1.0
      xpath: /jbc:classloading
- category: mandatory
  customVariables: []
  description: JBoss security configuration descriptor (prior to AS 7 / EAP 6)
  effort: 5
  labels:
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - source=eap5
  - source=eap
  - capability=java-ee6+
  - capability=java-ee
  - jboss-eap5
  - ejb
  - seam
  - security
  - discovery
  links:
  - title: JBoss EAP 6.4 - How To Configure Server Security
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/6.4/html-single/how_to_configure_server_security/
  - title: JBoss EAP 5 - Login Modules
    url: https://access.redhat.com/documentation/en-us/jboss_enterprise_application_platform/5/html-single/security_guide/#idm139921681412720
  message: |-
    Before JBoss EAP 6, authentication security domains and login modules could be configured in a `login-config.xml` file.
     JBoss EAP 6+ does not support the `login-config.xml` descriptor. Security is now configured inside the server configuration. Please refer to the corresponding server security guide.
  ruleID: jboss-eap5-xml-16000
  when:
    builtin.xml:
      filepaths:
      - login-config.xml
      namespaces: {}
      xpath: //*[local-name()='policy']