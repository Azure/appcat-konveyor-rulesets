- category: optional
  customVariables: []
  description: Stateful Session EJB Clustering configuration changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links: []
  message: The `clustered` element is ignored in EAP 7 and is not useful. In case
    the application is started using HA profile, the replication will be done automatically.
  ruleID: jboss-eap5and6to7-xml-37000
  when:
    builtin.xml:
      filepaths:
      - jboss-ejb3.xml
      namespaces: {}
      xpath: /*[local-name()='ejb-jar']/*[local-name()='assembly-descriptor']/*[local-name()='clustering']/*[local-name()='clustered']
- category: mandatory
  customVariables: []
  description: CMP Entity EJB configuration
  effort: 3
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - jpa
  - cmp
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links: []
  message: |-
    CMP entity beans are no longer supported in JBoss EAP 7. User is requested to use JPA entities that fully replaced the functionality provided by CMP beans.
     CMP configuration provided in this ejb-jar.xml should be configured using JPA persistence.xml or using JPA annotations.
  ruleID: jboss-eap5and6to7-xml-31000
  when:
    builtin.xml:
      filepaths:
      - ejb-jar.xml
      namespaces:
        j2e: http://java.sun.com/xml/ns/j2ee
        jcp: http://xmlns.jcp.org/xml/ns/javaee
        jee: http://java.sun.com/xml/ns/javaee
      xpath: /ejb-jar/enterprise-beans/entity[persistence-type = 'Container'] | /jee:ejb-jar/jee:enterprise-beans/jee:entity[jee:persistence-type
        = 'Container'] | /j2e:ejb-jar/j2e:enterprise-beans/j2e:entity[j2e:persistence-type
        = 'Container'] | /jcp:ejb-jar/jcp:enterprise-beans/jcp:entity[jcp:persistence-type
        = 'Container']
- category: mandatory
  customVariables: []
  description: EJB 2.x BMP Entity Beans configuration
  effort: 3
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - jpa
  - bmp
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links: []
  message: |-
    BMP entity beans are no longer supported in JBoss EAP 7. User is requested to use JPA entities that fully replaced the functionality provided by BMP beans.
     BMP configuration provided in this ejb-jar.xml should be configured using JPA persistence.xml or using JPA annotations.
  ruleID: jboss-eap5and6to7-xml-31500
  when:
    builtin.xml:
      filepaths:
      - ejb-jar.xml
      namespaces:
        j2e: http://java.sun.com/xml/ns/j2ee
        jcp: http://xmlns.jcp.org/xml/ns/javaee
        jee: http://java.sun.com/xml/ns/javaee
      xpath: /ejb-jar/enterprise-beans/entity[persistence-type = 'Bean'] | /jee:ejb-jar/jee:enterprise-beans/jee:entity[jee:persistence-type
        = 'Bean'] | /j2e:ejb-jar/j2e:enterprise-beans/j2e:entity[j2e:persistence-type
        = 'Bean'] | /jcp:ejb-jar/jcp:enterprise-beans/jcp:entity[jcp:persistence-type
        = 'Bean']
- category: mandatory
  customVariables: []
  description: Valve is not supported in JBoss EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - web
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links: []
  message: JBoss Web was replaced by Undertow, which does not contain support for
    the Valve functionality. It may be needed to migrate to Undertow handlers.
  ruleID: jboss-eap5and6to7-xml-32000
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces:
        jboss: http://www.jboss.com/xml/ns/javaee
      xpath: /jboss-web/valve | /jboss:jboss-web/jboss:valve
- category: mandatory
  customVariables: []
  description: JAX-RPC specific configuration
  effort: 3
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - rpc
  - jax-ws
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links: []
  message: JAX-RPC support was removed in JBoss EAP 7. All the RPC calls will need
    to be migrated to JAX-WS.
  ruleID: jboss-eap5and6to7-xml-33000
  when:
    or:
    - builtin.xml:
        namespaces:
          j2ee: http://java.sun.com/xml/ns/j2ee
          jcp: http://xmlns.jcp.org/xml/ns/javaee
          jee: http://java.sun.com/xml/ns/javaee
        xpath: /webservices/webservice-description/jaxrpc-mapping-file | /jee:webservices/jee:webservice-description/jee:jaxrpc-mapping-file
          | /jcp:webservices/jcp:webservice-description/jcp:jaxrpc-mapping-file |
          /j2ee:webservices/j2ee:webservice-description/j2ee:jaxrpc-mapping-file
    - builtin.xml:
        namespaces:
          j2ee: http://java.sun.com/xml/ns/j2ee
          jcp: http://xmlns.jcp.org/xml/ns/javaee
          jee: http://java.sun.com/xml/ns/javaee
        xpath: /ejb-jar/enterprise-beans/session/service-ref/jaxrpc-mapping-file |
          /jee:ejb-jar/jee:enterprise-beans/jee:session/jee:service-ref/jee:jaxrpc-mapping-file
          | /jcp:ejb-jar/jcp:enterprise-beans/jcp:session/jcp:service-ref/jcp:jaxrpc-mapping-file
          | /j2ee:ejb-jar/j2ee:enterprise-beans/j2ee:session/j2ee:service-ref/j2ee:jaxrpc-mapping-file
    - builtin.xml:
        namespaces:
          j2ee: http://java.sun.com/xml/ns/j2ee
          jcp: http://xmlns.jcp.org/xml/ns/javaee
          jee: http://java.sun.com/xml/ns/javaee
        xpath: /java-wsdl-mapping | /jee:java-wsdl-mapping | /jcp:java-wsdl-mapping
          | /j2ee:java-wsdl-mapping
- category: optional
  customVariables: []
  description: Web Session Clustering config replication-trigger changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: The EAP 7 Web Session Clustering configuration deprecates `replication-trigger`
    element in `jboss-web.xml` file descriptor.
  ruleID: jboss-eap5and6to7-xml-38000
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='replication-trigger']
- category: optional
  customVariables: []
  description: Web Session Clustering config replication-mode changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: The EAP 7 Web Session Clustering configuration deprecates element `replication-mode`
    element without replacement in `jboss-web.xml` file descriptor.
  ruleID: jboss-eap5and6to7-xml-38001
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='replication-mode']
- category: optional
  customVariables: []
  description: Web Session Clustering config backups changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: The EAP 7 Web Session Clustering configuration deprecates `backups` element
    without replacement in `jboss-web.xml` file descriptor.
  ruleID: jboss-eap5and6to7-xml-38002
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='backups']
- category: optional
  customVariables: []
  description: Web Session Clustering config use-jk changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration deprecates `use-jk` element without replacement in `jboss-web.xml` file descriptor.

     Previously by specifying `use-jk` element, the instance-id of the node handling a given request was appended to the jsessionid (foruse by load balancers such as mod_jk, mod_proxy_balancer, mod_cluster, etc.) depending on the value specified for `use-jk`.

     In the new implementation, the instance-id, if defined, is always appended to the jsessionid.
  ruleID: jboss-eap5and6to7-xml-38003
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='use-jk']
- category: optional
  customVariables: []
  description: Web Session Clustering config max-unreplicated-interval changes in
    EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration deprecates `max-unreplicated-interval` element in `jboss-web.xml` file descriptor.

     Previously, this configuration option was an optimization that would prevent the replication of a session’s timestamp if no session attribute was changed. While this sounds nice, in practice it doesn't prevent any RPCs, since session access requires cache transaction RPCs regardless of whether any session attributes changed.

     In the new implementation, the timestamp of a session is replicated on every request.
     This prevents stale session metadata following failover.
  ruleID: jboss-eap5and6to7-xml-38004
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='max-unreplicated-interval']
- category: optional
  customVariables: []
  description: Web Session Clustering config snapshot-mode changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration deprecates `snapshot-mode` element in `jboss-web.xml` file descriptor.

     Previously, one could configure `snapshot-mode` as INSTANT or INTERVAL. Infinispan’s replication queue renders this configuration option obsolete.
  ruleID: jboss-eap5and6to7-xml-38005
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='snapshot-mode']
- category: optional
  customVariables: []
  description: Web Session Clustering config snapshot-interval changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration removed `snapshot-interval` element from `jboss-web.xml` file descriptor.
     This option was only relevant for `<snapshot-mode>INTERVAL</snapshot-mode>`. Since `snapshot-mode` is no longer used, this option is no longer used as well.
  ruleID: jboss-eap5and6to7-xml-38006
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='snapshot-interval']
- category: optional
  customVariables: []
  description: Web Session Clustering config session-notification-policy changes in
    EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration deprecates `session-notification-policy` element in `jboss-web.xml` file descriptor.

     Previously `session-notification-policy` element defined a policy for triggering session events.

     In the new implementation, this behaviour is specification driven and not configurable.
  ruleID: jboss-eap5and6to7-xml-38007
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='replication-config']/*[local-name()='session-notification-policy']
- category: optional
  customVariables: []
  description: Web Session Clustering config passivation-config changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration deprecates `passivation-config` element and its sub-elements `use-session-passivation`, `passivation-min-idle-time` and `passivation-max-idle-time` completely in `jboss-web.xml` file descriptor.

     * `use-session-passivation` enabled the passivation, but now passivation is enabled by specifying a non-negative value for `max-active-sessions` element.

     * `passivation-min-idle-time` is not supported and the new implementation avoids waiting some time before the passivation.

     * `passivation-max-idle-time` is not supported and the new implementation supports only lazy passivation. Sessions are only passivated when necessary to comply with `max-active-sessions`.
  ruleID: jboss-eap5and6to7-xml-39000
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='passivation-config']
- category: optional
  customVariables: []
  description: Web Session Clustering config max-active-sessions changes in EAP 7
  effort: 1
  labels:
  - source=eap5
  - source=eap6
  - source=eap
  - jboss-eap5
  - jboss-eap6
  - ejb
  - cluster
  - web
  - configuration
  - domain=java-upgrade
  - category=deprecated-apis
  - os=windows
  - os=linux
  - target=azure-appservice
  - target=azure-aks
  - target=azure-container-apps
  - capability=java-ee7+
  - capability=java-ee
  links:
  - title: Web Session Clustering config migration changes in EAP 7
    url: https://access.redhat.com/documentation/en-us/red_hat_jboss_enterprise_application_platform/7.0/html-single/migration_guide/#migrate_web_session_clustering_changes
  message: |-
    The EAP 7 Web Session Clustering configuration changed `max-active-sessions` element meaning in `jboss-web.xml` file descriptor.

     Previously, session creation would fail if an additional session would cause the number of active sessions to exceed the value specified by `<max-active-sessions/>`.

     In the new implementation, `<max-active-sessions/>` is used to enable session passivation. If session creation would cause the number of active sessions to exceed `<max-active-sessions/>`,
     then the oldest session known to the session manager will passivate to make room for the new session.
  ruleID: jboss-eap5and6to7-xml-40000
  when:
    builtin.xml:
      filepaths:
      - jboss-web.xml
      namespaces: {}
      xpath: /*[local-name()='jboss-web']/*[local-name()='max-active-sessions']
